<!DOCTYPE>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="author" content="quillblue">
    <title>Task 15</title>
  </head>
  <body>
    <ul id="source">
      <li>北京空气质量：<b>90</b></li>
      <li>上海空气质量：<b>70</b></li>
      <li>天津空气质量：<b>80</b></li>
      <li>广州空气质量：<b>50</b></li>
      <li>深圳空气质量：<b>40</b></li>
      <li>福州空气质量：<b>32</b></li>
      <li>成都空气质量：<b>90</b></li>
    </ul>
    <ul id="resort"></ul>
    <button id="sort-btn">排序</button>
    <script type="text/javascript">
      /**
       * getData方法
       * 读取id为source的列表，获取其中城市名字及城市对应的空气质量
       */
      function getData() {
        var data=[]
        var sourceList=document.getElementById('source')
        for(var i=0;i<sourceList.children.length;i++){
          var cityData=sourceList.children[i];
          data.push([cityData.innerText.split('空气')[0],cityData.children[0].innerText])
        }
        return data;
      }

      /**
       * sortAqiData
       * 按空气质量对data进行从小到大的排序
       */
      function sortAqiData(data) {
        return data.sort(function(city1,city2){return city1[1]<city2[1]})
      }

      /**
       * render
       * 将排好序的城市及空气质量指数，输出显示到id位resort的列表中
       */
      function render(data) {
        var resortedList=document.getElementById('resort')
        for(var i=0;i<data.length;i++){
          var node=document.createElement('li')
          node.innerText='第'+(i+1)+'名：'+data[i][0]+' '+data[i][1]
          resortedList.appendChild(node)
        }
      }

      function btnHandle() {
        var aqiData = getData();
        aqiData = sortAqiData(aqiData);
        render(aqiData);
      }

      function init() {
        var btnSort=document.getElementById('sort-btn')
        btnSort.addEventListener('click',btnHandle)
      }

      init();

    </script>
  </body>
</html>